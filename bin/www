#!/usr/bin/nodejs
var debug = require('debug')('my-application');
var app = require('../app');
const fs = require('fs');

var WebSocketServer = require('ws');
var https = require('https');




let globalPlayers = {};

app.set('port', process.env.PORT || 7000);

app.globalPlayers = {};
app.viewers = {};


const options = {
    key: fs.readFileSync('/etc/letsencrypt/live/chessround.com/privkey.pem'),
    cert: fs.readFileSync('/etc/letsencrypt/live/chessround.com/fullchain.pem')
}

var server = https.createServer(options, app).listen(app.get('port'), function() {
    debug('Express server listening on port ' + server.address().port);
});

console.log("server");
/*var server = app.listen(app.get('port'), function() {
  debug('Express server listening on port ' + server.address().port);
});*/

const wss = new WebSocketServer.Server({ server });
app.wss = wss;

var socketApi = require('../socketApi')(app);
const timers = require('../routes/timers')(app);


//var io = socketApi.io;

//io.attach(server);

//app.io = io;
