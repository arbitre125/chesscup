!function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=84)}({15:function(t,e,n){"use strict";function o(t,e){this.callback=t||function(){},this.serverHost=location.host,this.errored=!1,this.connect()}Object.defineProperty(e,"__esModule",{value:!0}),o.sockets={},o.prototype.connect=function(){this.startNative()},o.prototype.startNative=function(){var t=this,e=void 0!==window.g_ws_params?window.g_ws_params:{},n=void 0!==window.u?{h:u}:{},o=this.getUrl(Object.assign(e,n));window.socketInited=!0;var r="https:"===location.protocol?"wss://":"ws://";this.ws=new WebSocket(r+t.serverHost+"/?"+o),this.ws.onopen=function(e){t.errored&&($("#showMessage").addClass("hidden"),location.reload()),t.interval&&clearInterval(t.interval),t.interval=setInterval(function(){t.ws.send(JSON.stringify({action:"ping"}))},15e3)},this.ws.onmessage=function(e){var n=JSON.parse(e.data);"pong"===n.action||("start_game"===n.action?void 0!==n.game_id&&n.tournament_id?"undefined"==typeof g?location.href="/tournament/"+n.tournament_id+"/game/"+n.game_id:isNaN(parseInt(g))||g==n.game_id||(location.href="/tournament/"+n.tournament_id+"/game/"+n.game_id):void 0===n.game_id||n.tournament_id||("undefined"==typeof g?location.href="/play/game/"+n.game_id:isNaN(parseInt(g))||g==n.game_id||(location.href="/play/game/"+n.game_id)):t.onMessage(n,t))},this.ws.onclose=function(e){t.stop(),console.log("WS CLOSED. RECONNECT IN 1 SECS"),setTimeout(function(){t.startNative()},1e3)},this.ws.onerror=function(){$("#showMessage").removeClass("hidden"),t.errored=!0,console.error("Не могу подключиться к нативным вебсокетам")}},o.prototype.getUrl=function(t){var e="";for(var n in t)""!=e&&(e+="&"),e+=n+"="+encodeURIComponent(t[n]);return e},o.prototype.onMessage=function(t,e){e.callback(t)},o.prototype.stop=function(t){var e=t||this.socket||this.ws;this.socket?e.disconnect():e.close();for(var t in o.sockets)o.sockets[t]===e&&delete o.sockets[t]},o.prototype.stopAll=function(){for(var t in o.sockets)this.stop(o.sockets[t]);return!0},o.prototype.showSonnections=function(){for(var t in o.sockets)console.log(t,o.sockets[t]);return!0},e.default=o},84:function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=n(15),s=function(t){return t&&t.__esModule?t:{default:t}}(i),a=function(){function t(){o(this,t),void 0===window.socketInited&&(this.socket=new s.default(function(){},location.host))}return r(t,[{key:"getUrl",value:function(t){var e="";for(var n in t)""!=e&&(e+="&"),e+=n+"="+encodeURIComponent(t[n]);return e}}]),t}();$(function(){new a})}});